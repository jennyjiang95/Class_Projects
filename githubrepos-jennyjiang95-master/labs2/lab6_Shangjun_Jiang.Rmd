---
title: "lab6"
author: "Shangjun Jiang"
date: "June 15, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Population Variance

Write a function `MyVar` that calculates the population variance of a vector.  If you need a refresher of what that means, [this section of wikipedia should help](https://en.wikipedia.org/wiki/Variance#Population_variance_and_sample_variance).

```{r}
MyVar <- function (x) {
  sum ((mean (x) - x)^2) / (length (x))
}
MyVar (c (1,2,3))

```

## Finding Roots
Write a function `zeroes` that finds the roots (zeroes) of a degree two polynomial.  The function should take the coefficients of the polynomial $a^2x + bx + c$ as its arguments and returns a vector of roots.  If there are no real roots, the function should stop and produce an error message: `"This polynomial has no real roots."`

Test your function:
```{r, eval = F}
zeroes <- function (a,b,c) {
  roots <- b^2 - 4*a*c
  den <- 2 *a
  
  if (roots < 0) {
    stop ("This polynomial has no real roots.")
  } else  if (roots == 0) {
    return (-b/den)
  } else {
    rr <- c((-b + sqrt(roots)) / den, (-b - sqrt(roots)) / den)
    return (rr)
  }
}


zeroes(1, 0, 0)
zeroes(1, 0, -1)
zeroes(1, 1, 1)

```

## Temperature Conversion

Write a function `ConvertTemperature` that takes a numeric vector of temperatures in Fahrenheit and converts them into Celsius, Kelvin, Rankine, Delisle, Newton, Reamur, or Romer, depending on what the user specifies in an argument called `to`.  If they specify some other temperature scale, return the message "The [their input] temperature scale is not supported".  If you don't know the conversions, (see this table)[https://en.wikipedia.org/wiki/Conversion_of_units_of_temperature#Fahrenheit]

Test your function
```{r, eval = F}
ConvertTemperature <- function (x, y){
  if (y == "Celsius"){
    return ((x - 32)* (5/9))
  }else if (y == "Kelvin"){
    return ((x+459.67)* (5/9))
  }else if (y == "Rankine") {
    return (x +459.67)
  }
}
ConvertTemperature (32, "Celsius")
  
ConvertTemperature(32, "Celsius") == 0
ConvertTemperature(212, "Kelvin") == 373.15
ConvertTemperature(10, "Rankine") == 501.67
```


## Rolling Dice

For this problem, you'll need the `sample` and `pmax` function.  `sample` generates a random sample of a specified size either with or without replacement.  You can specify probability weights for each element of your sample space using the `prob` argument.  By default, each element will have equal probability.
```
sample(x = vector_to_be_sampled, size, replace = FALSE, prob = NULL)
```
1. What does `pmax` do? How is it different from `max`? Hint: test both on the two vectors `c(1, 5, 3)` and `c(2, 4, 2)`.

```{r}
a <- c(1,5,3)
b <- c(2,4,9)
c <- c(5,1,10)
pmax (a,b,c)
pmax (c(1,5,3), c(2,4,2))
max (c(1,5,3), c(2,4,2))
pmax (c(2,6,8), c(1,4,9))
```
pmax returns the parallel maxima vector of multiple vectors or matrix. 
Contrast the oridnary max function which only returns the max of a scalar value. 

2. When you "roll dice with advantage", you roll a pair of dice and take the higher value as your roll.  Write a function `AdvRoll` the simulates rolling with advantage `n` times. The function should take on 2 arguments `sides` and `n` and output a length `n` vector of rolls.
```{r}

AdvRoll <- function (sides, n){
  sides <- sample (n, sides)
    results <-(pmax (sides))
  return (results)
}
AdvRoll(6,2)

AdvRoll <- function(sides, n) {
  first_rolls <- sample(sides, n, replace = TRUE)
  second_rolls <- sample(sides, n, replace = TRUE)
  pmax(first_rolls, second_rolls)
}

AdvRoll(20,2)

```


3. Write your own summary function called `MySummary` that, given a numeric vector `x`, returns the following summary statistics: mean, median, mode, sum, and sum of squares.
```{r}
modee <- function (x){
  return (x[(which.max(table(x)))])
}
as.numeric(names(sort(table(x), T)) [1])
?as.numeric
?names
names 
as.numeric (names (sort(table (AdvRoll (6,1000)), T)) [1])

MySummary <- function (x){
  list (mean = mean (x),
        median = median (x),
        mode = as.numeric (names (sort(table (AdvRoll (6,1000)), T)) [1]),
        sum = sum (x),
        sum_of_squares = sum (x^2))
}

```

4. Using your two functions, simulate "rolling dice with advantage" 1000 times and find the summary statistics.
```{r}
MySummary (AdvRoll (6,1000))
```












