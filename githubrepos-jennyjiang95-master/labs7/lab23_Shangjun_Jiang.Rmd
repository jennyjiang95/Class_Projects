---
title: "lab23"
author: "Shangjun Jiang"
date: "July 20, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## GeoJSON and Earthquakes

The United States Geological Survey (USGS) keeps a public running record of detected earthquakes on its website, updated once every 15 minutes.  Included with this lab is the earthquake data for the past 30 days as of 6am today.  Your task is to spatially display all the earthquakes in the continental US.  You should somehow represent the magnitude of the earthquakes in your visualization.

earthquake <- fromJSON("https://api.github.com/users/doctordo/repos")


```{r}
library(jsonlite)
library(maps)
library(mapdata)
library(lubridate)
library(ggplot2)
#setwd("~/Desktop/Stats R/stat133-su2016/23-lesson/lab")
earthquake <- fromJSON("all_month.geojson", F, T, F)
names(earthquake)

states <- map_data("state")
feature <-earthquake$features
geo <- feature$geometry
df<- as.data.frame(matrix(unlist(geo$coordinates),ncol = 3, byrow = T))
mag <- feature$properties

ndf <- data.frame("V1"=df$V1,"V2"=df$V2,"mag" =mag$mag)

ggplot(states) + 
  geom_polygon(aes(x = long, y = lat, fill = region, group = group), color = "white") + 
  coord_fixed(1.3) +
  geom_point(data=ndf, x=ndf$V1, y=ndf$V2)+
  guides(fill = FALSE) 


earthquake$type
# "FeatureCollection"
earthquake$metadata
# generated, url, title, status, api, count
names(earthquake$features) 
# "type"  "properties" "geometry"   "id"  
earthquake$bbox
# -179.9646  -62.6274   -3.3500  179.9876   85.2521  611.8700

```











